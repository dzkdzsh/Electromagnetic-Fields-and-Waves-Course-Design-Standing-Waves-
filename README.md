# **Advanced EM Lab - 电磁场与波虚拟仿真平台用户手册**

**版本**: v11

**适用课程**: 电磁场与波 / 微波技术与天线

**主题**: 驻波原理及其实验研究

## **1. 软件概述 (Overview)**

**Advanced EM Lab** 是一款专为电磁场课程设计的高级交互式仿真软件。本软件旨在突破传统二维静态图表的限制，通过多维动态可视化技术，直观展示传输线上的电压/电流驻波、复数矢量旋转以及阻抗匹配过程。

**核心亮点：**

* **多维可视化**：集成了 2D 时域波形、3D 复数螺旋矢量、史密斯圆图 (Smith Chart) 三种专业视图。  
* **实时交互**：支持通过滑块或精确数值实时调节负载阻抗、特性阻抗及衰减常数。  
* **物理深度**：完整求解有耗传输线方程，实时计算 VSWR、反射系数 $\Gamma$、回波损耗等关键工程指标。  
* **视觉增强**：采用“暗黑科幻 (Dark Sci-Fi)”UI 主题，提供沉浸式的实验体验。

## **2. 运行环境与安装**

### **2.1 系统要求**

* **软件**: MATLAB R2016b 或更高版本 (推荐 R2020a+ 以获得最佳图形性能)。  
* **工具箱**: 无需额外工具箱 (基于 MATLAB 基础绘图引擎开发)。  
* **硬件**: 支持 OpenGL 的显卡 (推荐独立显卡以流畅运行 3D 动画)。

### **2.2 安装与启动**

1. 将核心文件 Advanced_EM_Simulator.m 保存至 MATLAB 的当前工作目录。  
2. 在 MATLAB 命令行窗口 (Command Window) 输入以下命令并回车：  
   Advanced_EM_Simulator

3. 等待几秒钟，系统初始化完成后会自动弹出仿真主窗口。

## **3. 界面功能详解**

软件界面主要分为三个区域：**顶部视图控制栏**、**左侧参数控制台**、**中央主绘图区**。

### **3.1 顶部视图控制栏 (View Mode)**

位于界面最上方，用于一键切换不同的观察维度：

* **2D 模式**: 经典的电压/电流驻波图。适合观察波腹、波节位置及包络线形状。
  <img width="2560" height="1528" alt="2d" src="https://github.com/user-attachments/assets/30a30478-a78c-4350-a32e-e99e2a13f1ad" />

* **3D 模式**: 展现电磁波的本质——复数矢量螺旋。适合理解“驻波是由两个反向旋转的矢量合成”这一物理概念。
   <img width="2560" height="1528" alt="3d" src="https://github.com/user-attachments/assets/63cd3db9-7d12-4082-8812-ec0f1541c0f4" />

* **Smith 模式**: 动态史密斯圆图。适合进行阻抗匹配分析，观察负载点随参数的变化轨迹。
   <img width="2560" height="1528" alt="史密斯圆图" src="https://github.com/user-attachments/assets/cea65542-8c31-43e3-88dd-69ca8f63af2e" />

### **3.2 左侧参数控制台 (Parameter Control)**

位于界面左侧，提供实验参数的实时调节功能：

| 参数名称 | 符号 | 调节范围 | 说明 |
|---------|------|---------|------|
| 负载电阻 | $R_L$ | $0 \sim 200\ \Omega$ | 调节负载的实部。$R_L=Z_0$ 时匹配，$R_L=0$ 为短路。 |
| 负载电抗 | $X_L$ | $-200 \sim +200\ \Omega$ | 调节负载的虚部。$>0$ 为感性，$<0$ 为容性。 |
| 特性阻抗 | $Z_0$ | $10 \sim 100\ \Omega$ | 传输线的固有属性，通常设为 $50\ \Omega$ 或 $75\ \Omega$。 |
| 衰减常数 | $\alpha$ | $0 \sim 0.5\ \text{Np/m}$ | 模拟有耗传输线。$\alpha > 0$ 时波幅随距离衰减。 |

* **操作方式**：既可以拖动滑块粗调，也可以在右侧文本框输入精确数值（回车生效）。  
* **实时指标面板**：下方实时显示当前的驻波比 (VSWR)、反射系数 ($\Gamma$) 幅度与相位、回波损耗 (Return Loss)。

### **3.3 中央主绘图区 (Visualization Area)**

#### **A. 2D 视图 (Voltage & Current)**

* **上图**: 显示电压 (青色实线) 和电流 (洋红点划线) 的瞬时波形。  
  * **绿色虚线**: 驻波包络线，表示电压振幅的最大可能值。  
* **下图**: 显示沿线阻抗模值 $|Z(z)|$ 的分布。  
  * **绿色水平虚线**: 特性阻抗 $Z_0$ 参考线。

#### **B. 3D 视图 (Phasor Space)**

* **白色粗线**: 合成电压驻波的复数轨迹。  
* **青色细线**: 入射波 (向 $+z$ 传播) 的螺旋轨迹。  
* **洋红细线**: 反射波 (向 $-z$ 传播) 的螺旋轨迹。  
* **动态箭头**:  
  * **青色箭头**: 指示入射波在 $z=0$ 处的瞬时矢量方向。  
  * **洋红箭头**: 指示反射波在 $z=0$ 处的瞬时矢量方向。  
  * **白色箭头**: 指示合成波在 $z=0$ 处的瞬时矢量方向 (即负载电压)。  
* **操作技巧**: 在此视图下，按住鼠标左键拖动可**360度旋转视角**，观察螺旋结构。

#### **C. Smith 圆图 (Impedance Chart)**

* **红色圆点**: 当前归一化负载阻抗点 $z_L = Z_L / Z_0$。  
* **绿色虚线圆**: 等驻波比圆 (Constant VSWR Circle)。  
* **物理意义**: 当调节参数时，观察红点相对于圆心的位置。红点重合于圆心即为完美匹配。

## **4. 典型实验操作流程**

### **实验一：理想无耗传输线的驻波观测**

1. **设置**: 将衰减常数 $\alpha$ 设为 0。  
2. **全反射 (短路/开路)**:  
   * 将 $R_L$ 设为 0 (短路) 或 200 (近似开路)。  
   * 观察 2D 视图：包络线触底 (最小值为0)，形成纯驻波。  
   * 观察 3D 视图：入射与反射螺旋幅度相等。  
3. **匹配状态**:  
   * 将 $R_L$ 设为 50，$X_L$ 设为 0，$Z_0$ 设为 50。  
   * 观察：VSWR = 1.0，包络线变为一条直线（行波状态）。Smith 图红点位于圆心。

### **实验二：有耗传输线的衰减特性**

1. **设置**: 将 $\alpha$ 逐渐增大至 0.1 或更高。  
2. **观察**:  
   * 2D 视图：驻波包络不再平直，而是呈现向源端（左侧）逐渐“张开”的喇叭口形状。  
   * 3D 视图：螺旋线的半径随着传播距离明显缩小。  
   * 物理含义：能量在传输过程中转化为热能损耗。

### **实验三：阻抗匹配与 Smith 圆图**

1. **设置**: $Z_0=50$，随机设置 $R_L=25, X_L=25$ (失配)。  
2. **观察**: 此时 VSWR > 1，Smith 图上红点偏离圆心。  
3. **操作**: 尝试调节 $R_L$ 和 $X_L$ 滑块，使红点逐渐逼近圆心，体验"调匹配"的过程。

## **5. 常见问题 (FAQ)**

**Q1: 为什么初始化时显示 "System initializing..." 并卡顿几秒？** A: 程序正在预计算 Smith 圆图的复杂背景网格和初始化图形对象句柄池。这是为了保证后续动画运行流畅而进行的一次性开销。

**Q2: 3D 视图旋转时感觉有点慢？** A: 为了清晰展示矢量的旋转细节，我们将动画速度刻意调优为 1/150 周期/帧。这使得用户可以看清“入射波”与“反射波”是如何反向旋转并合成“不动”的驻波的。

**Q3: 为什么输入数值后滑块没有动？** A: 请确保在输入数值后按下了 **回车键 (Enter)**，或者点击了界面其他区域，以触发数值更新事件。

**版权说明**: 本软件仅供课程设计与学术交流使用。

**开发团队**:

* **小组成员** (排名不分先后，按姓氏拼音排序): 陈东山, 刘岳达, 田星宇, 王凯, 赵修泽, 庄尚翰  

  
